<div id="app-container">

  <!-- App Modals -->
  <app-license-lockout
    (triggerApplyLicense)="licenseApplyModal.openModal();"
    #licenseLockoutModal>
  </app-license-lockout>

  <app-license-apply
    #licenseApplyModal
    (openLicenseLockout)="licenseLockoutModal.openModal()">
  </app-license-apply>

  <app-feature-flags
    [experimentalFeatures]="experimentalFeatures"
    [betaFeatures]="betaFeatures"
    [legacyFeatures]="legacyFeatures">
  </app-feature-flags>
  
  <!-- App Header -->
  <div id="app-header-wrapper" [hidden]="!layoutFacade.layout.header.display">
    <app-license-notifications (triggerApplyLicense)="licenseApplyModal.openModal();"></app-license-notifications>
    <app-navbar></app-navbar>
  </div>

  <!-- App Content -->
  <div id="app-content-wrapper"
    [attr.hasNotifications]="layoutFacade.hasGlobalNotifications() ? true : null"
    [attr.hasUserNotifications]="layoutFacade.hasUserNotifications() ? true : null"
    [ngStyle]="layoutFacade.getContentStyle()">
    <div id="main-content-wrapper">
      <div id="notifications-wrapper" class="sticky-notifications">
        <app-chef-notifications></app-chef-notifications>
      </div>
      <chef-loading-spinner [hidden]="!(layoutFacade.showPageLoading$ | async)" size='50' fixed></chef-loading-spinner>
      <router-outlet></router-outlet>
    </div>
    <!-- App Sidebar -->
    <div [hidden]="!layoutFacade.layout.sidebar.display">
      <chef-sidebar id="app-sidebar" [hidden]="!layoutFacade.layout.sidebar.navigation"></chef-sidebar>
    </div>
  </div>
  
  <!-- User Notifications -->
  <div [hidden]="!layoutFacade.layout.userNotifications.display">
    <app-process-progress-bar></app-process-progress-bar>
    <app-pending-edits-bar></app-pending-edits-bar>
  </div>

  <!-- TEMP FOR TIME SELECTION DEMO -->
  <div class="time-test" [class.active]="showTime">
    <button class="show-button" (click)="toggleTime()" [class.active]="showTime">&#9650;</button>
    <h3>Current Time:</h3>
    <p>{{ currentTime | datetime: 'ddd, DD MMM YYYY HH:mm z'}}</p>
    <div class="hacky-line-break"></div>
    <chef-form-field class="timezone-field">
      <label for="timeformat">Time Format</label>
      <chef-select #timeformat [value]="(userPrefsService.timeformat$ | async)?.value"
        (change)="handleTimeFormatChange(timeformat.value)">
        <chef-option value="ddd, DD MMM YYYY">ddd, DD MMM YYYY</chef-option>
        <chef-option value="MM DD YYYY">MM DD YYYY</chef-option>
        <chef-option value="MM DD - HH:mm z">MM DD - HH:mm z</chef-option>
      </chef-select>
    </chef-form-field>
    <div class="button-container">
      <button class="test-get" (click)="handleGetPrefs()">Test Get Timezone</button>
    </div>
  </div>
</div>
